Задание 1: Анализ требований
1. Логические противоречия:
    • Пункты 2 и 9: Противоречие в логике удаления товара.
      В п.2 сказано, что для удаления товара используется отдельная кнопка,  минимальное количество - 1 (это же указано и в п.1). Тогда как в п.9 говорится, что уменьшение количества до 0 приводит к удалению. Эти пункты противоречат друг другу и избыточны.
    • Пункты 1, 3, 4: Противоречие в установленных лимитах.
      Формулировка установленных лимитов нечеткая и может создавать конфликты и противоречия, например, по данной логике, мы можем добавить 5 разных товаров по 10 единиц каждого рода товара. Таким образом, мы получим суммарно 50 товаров, однако п.4 нас в этом ограничивает. В таких частных случаях, эти пункты будут противоречивыми. 
    • Пункт 3 и 5: Избыточная и нечеткая формулировка.
      П.5 будет некоторым образом тавтологией, повторяя смысл п.3. Это избыточно и не несет за собой полезной смысловой нагрузки, кроме того оно может быть противоречивым, так как не несет ограничения.
    • Пункт 6: Не детальное описание ошибки.
      Для пользователя сообщение «Лимит корзины превышен» не информативно. Пользователь не поймет, какой именно из трех лимитов превышен: когда превышено количество одного товара (п.1), число разных товаров (п.3) или на общее количество единиц (п.4). Пользовательский опыт в таком случае будет плохим.
    • Пункты 7 и 13: Противоречие ценообразования.
      Один из основных моментов работы в кейсах с корзинами, проблема в прямом противоречии этих пунктов: 7 четко устанавливает, что цена фиксируется при добавлении и не меняется, а п.13 требует автоматически обновлять цену в корзине при ее изменении в каталоге. Это взаимоисключающие требования.
    • Пункт 10 и 11: Неправильная классификация требований
    • П.10 и П.11 описывают не функционал корзины, а больше маркетинг, это скорее бизнес-правило. Кроме того, их реализация зависит от внешних систем. Также формулировка нечеткая( какая именно реклама, какие часовые пояса, конкретное время).
    •  П.12 пропущен, многие ключевые моменты отсутствуют (например, нет описания при применении промокодов/скидок, итоговой суммы корзинв, ситуация когда закончился товар из корзины, либо при добавлении в корзину).
2. Моя версия ТЗ:
Раздел ТЗ: Функционал «Корзина покупателя»
1. Ценообразование (может быть выделено как отдельными бизнес-правилами, так и в рамках функционала корзины - как система реализует БП)
    • Цена товара в корзине является динамической и автоматически синхронизируется с актуальной ценой в каталоге магазина.
    • Обновление цены для позиций в корзине пользователя происходит в момент загрузки страницы корзины, а также при любом действии с товаром в корзине (например, изменение количества товара или  применение промокода).
    • В процессе оформления заказа, цена товара фиксируется на момент перехода на первый шаг оформления заказа и далее не изменяется в рамках текущей сессии оформления.
2. Добавление товара.
    • Суммарное количество всех товаров не должно превышать 20 единиц.
    • Пользователь может добавить в корзину от 1 до 10 единиц одного товара, не превышая суммарного лимита.
    • При последующем добавлении уже существующего в корзине товара его количество увеличивается, если это не нарушает лимиты.
    • Максимальное количество различных товаров равно 5.
    • При действии пользователя, которое приведет к превышению любого из лимитов (добавление товара, увеличение его количества), система блокирует это действие и показывает всплывающее сообщение. Сообщение должно конкретизировать причину ошибки (например, «Достигнут лимит в Х различных товаров»,  «Нельзя добавить более Х единиц этого товара» , «Вы превысили лимит в 20 товаров»).
      
3. Управление содержимым корзины
    • Пользователь может добавить в корзину товар из каталога. При добавлении система должна проверить соответствие лимитам в п.2.
    • Пользователь может увеличивать или уменьшать количество для каждой позиции в корзине с помощью элементов управления «+» / «-». 
    • Для удаления товара из корзины используется отдельная кнопка «Удалить» для каждой позиции. Уменьшение количества товара до 0 через элемент управления приравнивается к удалению.
    • Пользователь может очистить всю корзину полностью одной кнопкой «Очистить корзину».
4. Отображение корзины
    • На странице корзины для каждой позиции отображается:
        ◦ Изображение и наименование товара, его характеристики (объем, размер)
        ◦ Текущее количество с элементами управления.
        ◦ Кнопка «Удалить».
        ◦ Актуальная цена (для нескольких позиций - общая стоимость позиции «количество*актуальная цена за единицу».
        ◦ При применении промокодов или при действии акций/скидок старая цена отображается зачеркнутой, новая цена с учетом скидки выделена цветом.
    • В отдельном блоке страницы корзины система должна отображать:
        ◦ Общее количество позиций в корзине.
        ◦ Общую стоимость всех товаров (сумма общих стоимостей всех позиций).
        ◦ Окно для ввода промокода с кнопкой «Применить».
        ◦ Кнопку «Выделить» для множественного выбора (массового удаления или выделения определенных позиций для заказа).
          
(Требования по рекламе исключены из ТЗ на функционал корзины, так как относятся к маркетинговым блокам на странице.)


3. Уточняющие вопросы к продукт-менеджеру / бизнес-заказчику:
    1. Какая бизнес-модель ценообразования является приоритетной?
    2. Какова бизнес-цель установления именно таких лимитов (5 товаров, 20 и 10 единиц)?  Что является наивысшим приоритетом при конфликте лимитов (например, если в корзине 4 разных товара по 6 штук = 24 штуки, нарушен общий лимит. Запрещать добавление 5-го товара или запрещать увеличение существующих?)?
    3. Как следует обрабатывать ситуацию, если в момент нахождения пользователя на странице оформления заказа товар исчез из каталога?
    4. Можно ли получить доступ к отдельному ТЗ или требованиям рекомендаций/рекламы в корзине? Необходимо понять логику подбора рекламных товаров, правила показа, частоту обновления, чтобы корректно спроектировать интеграцию этого блока.
    5. Нужна ли возможность сохранять корзину между сессиями (для неавторизованных пользователей)? 
    6. Нужна ли функция «Отложить на потом» (перемещение товара в «Отложенное/ Понравившееся»)?


Задание 2: проектирование API

Метод: GET
Endpoint: /api/v1/partners
Параметры запроса (опционально) :
    • latitude,
    • longitude,
    • delivery_date,
    • city.
Если какие-то параметры не указаны, они устанавливаются по умолчанию:
"latitude": 55.7558,
"longitude": 37.6173,
"delivery_date": "2025-02-02",
"city": "Москва".

Пример запроса:
GET /api/v1/partners?latitude=55.7558&longitude=37.6173
Authorization: Bearer <access_token>
Пример ответа API
json
{
  "status": "success",
  "data": {
    "userLocation": {
      "latitude": 55.7558,
      "longitude": 37.6173,
      "address": "Москва, Красная площадь"
    },
    "stores": [
    {
      "id": 1,
      "name": "METRO",
      "deliveryInfo": "Ближайшая доставка сегодня 21:00-23:00",
      "deliveryTimeRange": {
        "date": "сегодня",
        "start": "21:00",
        "end": "23:00"
      },
      "isFastDelivery": false,
      "externalUrl": "https://link-to-resourses",
      "logoUrl": "https://link-to-resourses/logo",
    },
    {
      "id": 2,
      "name": "Ашан",
      "deliveryInfo": "Ближайшая доставка сегодня 18:00-20:00",
      "deliveryTimeRange": {
        "date": "сегодня",
        "start": "18:00",
        "end": "20:00"
      },
      "isFastDelivery": false,
      "externalUrl": "https://link-to-resourses",
      "logo_url": "https://link-to-resourses/logo",

    },
    {
      "id": 3,
      "name": "ВкусВилл",
      "deliveryInfo": "Быстрая доставка от 20 до 60 минут",
      "deliveryTimeRange": null,
      "isFastDelivery": true,
      "fastDeliveryMinutes": {
        "min": 20,
        "max": 60
      },
      "externalUrl": "https://link-to-resourses",
      "logoUrl": "https://link-to-resourses/logo",
    },
    {
      "id": 4,
      "name": "ВИКТОРИЯ",
      "deliveryInfo": "Ближайшая доставка сегодня 17:00-19:00",
      "deliveryTimeRange": {
        "date": "сегодня",
        "start": "17:00",
        "end": "19:00"
      },
      "isFastDelivery": false,
      "externalUrl": "https://link-to-resourses",
      "logoUrl": "https://link-to-resourses/logo",
    }
  ],
}
Задание 3: архитектура

Описание компонентов:
    1. Микросервисы-источники:
        ◦ Сервис корзины: события о бездействии корзины.
        ◦ Сервис заказов: события об отмене заказа, изменении статуса.
        ◦ Маркетинговый сервис: рекламные рассылки.
        ◦ Другие сервисы, которые могут инициировать уведомления.
    2. Очередь сообщений:
        ◦ Событийная шина для асинхронного приема событий от микросервисов (Apache Kafka, RabbitMQ).
    3. Сервис уведомлений (Notification Service):
        ◦ Обрабатывает входящие события, определяет тип уведомления, получателя, шаблон, проверяет подписки.
        ◦ Формирует окончательное сообщение для отправки.
        ◦ Сохраняет уведомление в базу данных для истории и отслеживания.
        ◦ Помещает задачу на отправку в очередь уведомлений.
    4. База данных уведомлений:
        ◦ Хранит все уведомления с их статусами (создано, отправлено, доставлено, прочитано) и метаданными.
    5. Очередь уведомлений:
        ◦ Очередь для асинхронной отправки уведомлений. Сервис рассылки забирает задачи из этой очереди. Это позволяет контролировать нагрузку на внешние сервисы (FCM/APNS) и реализовать повторные попытки при ошибках.
    6. Сервис рассылки :
        ◦ Отвечает за отправку уведомлений через соответствующие платформенные сервисы (Firebase Cloud Messaging для Android, Apple Push Notification Service для iOS).
        ◦ Обрабатывает ответы от этих сервисов и обновляет статусы уведомлений в базе данных.
    7. Внешние сервисы push-уведомлений:
        ◦ FCM (Firebase Cloud Messaging) для Android и веба.
        ◦ APNS (Apple Push Notification Service) для iOS.
    8. Мобильное приложение:
        ◦ Получает уведомление и отображает его пользователю.
        ◦ Отправляет события обратно на сервер при взаимодействии с уведомлением (открытие, нажатие на кнопку).



<img width="343" height="822" alt="изображение" src="https://github.com/user-attachments/assets/9988ce94-152b-455f-9343-05c7bd81717d" />

<img width="464" height="912" alt="изображение" src="https://github.com/user-attachments/assets/45dbab0f-df37-4b90-a581-4363367b7d72" />


